import{R as o}from"./chunks/index.0d03162d.js";import{b as T,H as E,a as O}from"./chunks/Button.2b6dfff2.js";import"./chunks/styles.module.15095df9.js";import{j as s}from"./chunks/jsx-runtime.44949ced.js";import{u as U,C as $}from"./chunks/useCookies.d8b58892.js";import{S as d,T as c}from"./chunks/TextField.4d6ba0aa.js";import{z}from"./chunks/Menu.1dfd0068.js";import"./chunks/index.469f5992.js";const A=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),K=({url:e="https://api.kbve.com/api/auth/local/register",display:t=!0})=>{const r=o.useRef(null),[n,a]=o.useState(!1),[i,l]=o.useState(""),[u,p]=o.useState(""),[m,x]=o.useState(""),[f,h]=o.useState(""),[j,g]=U(["member"]),[b,k]=o.useState(!1);//! Core -> [START] -> EOF
return s.exports.jsx(d,{direction:"column",alignItems:"center",children:s.exports.jsx(z,{variant:"outlined",children:s.exports.jsx(T,{component:"form",maxWidth:"sm",children:s.exports.jsxs(d,{direction:"column",justifyContent:"center",spacing:2,p:2,sx:{flex:1},children:[s.exports.jsx(c,{id:"username-input",type:"username",label:"Username",value:i,error:""!==i,onChange:e=>l(e.target.value),disabled:b}),s.exports.jsx(c,{id:"email-input",type:"email",label:"Email",value:u,error:""!==u&&!A(u),onChange:e=>p(e.target.value),disabled:b}),s.exports.jsx(c,{id:"password-input",type:"password",label:"Password",value:m,error:""!==m&&m!==f,onChange:e=>x(e.target.value),disabled:b}),s.exports.jsx(c,{id:"confirm-password-input",type:"password",label:"Confirm Password",value:f,error:""!==f&&m!==f,onChange:e=>h(e.target.value),disabled:b}),s.exports.jsx(E,{ref:r,sitekey:"e77af3f6-a0e3-44b7-82f8-b7c098d38022",onVerify:(e,s)=>((e,s)=>{console.log({token:e,eKey:s}),a(e)})(e,s)}),s.exports.jsx($,{in:!!n,children:s.exports.jsx(d,{direction:"column",alignItems:"flex-end",children:s.exports.jsx(O,{variant:"contained",fullWidth:!0,onClick:async s=>{s.preventDefault(),k(!0),await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i,email:u,password:m,token:n})}).then((async e=>{if(!e.ok)return k(!1),console.error(`\tRegisterConfirmation::An Error Occurred (${e.statusText})`),console.log(`Error: ${e}`),r.current?.resetCaptcha(),new Error(e.statusText);const s=await e.json().then((e=>{console.log("Data:",e),console.log("JWT",e.jwt),console.log("User",e.user),new Promise(((s,t)=>{s(((e,s)=>{g("jwt",e,{path:"/",domain:".kbve.com"}),g("user",s,{path:"/",domain:".kbve.com"})})(e.jwt,e.user))})).then(window.location="https://kbve.com/profile")}));console.log(`\tRegisterConfirmation::Success:\n${JSON.stringify(s,null,2)}`)}))},disabled:b,children:"Sign Up"})})})]})})})})};export{K as default};