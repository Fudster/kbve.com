import{R as s}from"./index.39e0ea27.js";import{B as b,T as p,H as k,a as E}from"./TextField.6a2d80c8.js";import{j as t}from"./jsx-runtime.e181d7ea.js";import{u as L}from"./useCookies.4e3fc4fd.js";import{S as l,P as T,y as P}from"./ButtonBase.14da95ee.js";import"./_commonjsHelpers.87174ba5.js";import"./index.00faf15b.js";const R=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),H=({url:e="https://api.kbve.com/api/auth/local/",display:o=!0})=>{const n=s.useRef(null),[a,r]=s.useState(!1),[i,c]=s.useState(""),[d,u]=s.useState(""),[m,f]=L(["user"]),[j,h]=s.useState(!1);s.useState(!1);return t.jsx(l,{direction:"column",alignItems:"center",children:t.jsx(T,{variant:"outlined",children:t.jsx(b,{component:"form",maxWidth:"sm",children:t.jsxs(l,{direction:"column",justifyContent:"center",spacing:2,p:2,sx:{flex:1},children:[t.jsx(p,{id:"email-input",type:"email",label:"Email",value:i,error:""!==i&&!R(i),onChange:e=>c(e.target.value),disabled:j}),t.jsx(p,{id:"password-input",type:"password",label:"Password",value:d,error:""!==d,onChange:e=>u(e.target.value),disabled:j}),t.jsx(k,{ref:n,sitekey:"e77af3f6-a0e3-44b7-82f8-b7c098d38022",onVerify:(e,t)=>((e,t)=>{console.log({token:e,eKey:t}),r(e)})(e,t)}),t.jsx(P,{in:!!a,children:t.jsx(l,{direction:"column",alignItems:"flex-end",children:t.jsx(E,{variant:"contained",fullWidth:!0,onClick:async t=>{t.preventDefault(),h(!0),await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:i,password:d,token:a})}).then((async e=>{if(!e.ok)return h(!1),n.current?.resetCaptcha(),console.error(`\tLoginConfirmation::An Error Occurred (${e.statusText})`),console.log(`Error: ${e}`),new Error(e.statusText);const t=await e.json().then((e=>{console.log("Data:",e),console.log("JWT",e.jwt),console.log("User",e.user),new Promise(((t,s)=>{t((e=>{f("user",e,{path:"/",domain:".kbve.com",secure:!0,sameSite:"strict"})})(e.user))})).then(window.location="https://kbve.com/profile")}));console.log(`\tLoginConfirmation::Success:\n${JSON.stringify(t,null,2)}`)}))},disabled:j,children:"Login"})})})]})})})})};export{H as default};