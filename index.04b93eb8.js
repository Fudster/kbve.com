import{R as s}from"./chunks/index.0d03162d.js";import{a as v,H as k,B as L}from"./chunks/Button.73f36f4f.js";import"./chunks/styles.module.d7c222e5.js";import{j as o}from"./chunks/jsx-runtime.44949ced.js";import{u as T}from"./chunks/useCookies.35608aca.js";import{S as l}from"./chunks/Stack.f6b01292.js";import{P as E}from"./chunks/utils.3181c515.js";import{T as d}from"./chunks/TextField.706a7d2f.js";import{C as P}from"./chunks/Collapse.8c9ba0a5.js";import"./chunks/ButtonBase.21103e88.js";import"./chunks/index.469f5992.js";import"./chunks/Menu.f3297af5.js";const R=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),U=({url:e="https://api.kbve.com/api/auth/local/",display:t=!0})=>{const n=s.useRef(null),[r,a]=s.useState(!1),[i,c]=s.useState(""),[u,m]=s.useState(""),[p,f]=T(["member"]),[h,x]=s.useState(!1);//! Core -> [START] -> EOF
return o.exports.jsx(l,{direction:"column",alignItems:"center",children:o.exports.jsx(E,{variant:"outlined",children:o.exports.jsx(v,{component:"form",maxWidth:"sm",children:o.exports.jsxs(l,{direction:"column",justifyContent:"center",spacing:2,p:2,sx:{flex:1},children:[o.exports.jsx(d,{id:"email-input",type:"email",label:"Email",value:i,error:""!==i&&!R(i),onChange:e=>c(e.target.value),disabled:h}),o.exports.jsx(d,{id:"password-input",type:"password",label:"Password",value:u,error:""!==u,onChange:e=>m(e.target.value),disabled:h}),o.exports.jsx(k,{ref:n,sitekey:"e77af3f6-a0e3-44b7-82f8-b7c098d38022",onVerify:(e,s)=>((e,s)=>{console.log({token:e,eKey:s}),a(e)})(e,s)}),o.exports.jsx(P,{in:!!r,children:o.exports.jsx(l,{direction:"column",alignItems:"flex-end",children:o.exports.jsx(L,{variant:"contained",fullWidth:!0,onClick:async s=>{s.preventDefault(),x(!0),await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:i,password:u,token:r})}).then((async e=>{if(!e.ok)return x(!1),n.current?.resetCaptcha(),console.error(`\tLoginConfirmation::An Error Occurred (${e.statusText})`),console.log(`Error: ${e}`),new Error(e.statusText);const s=await e.json().then((e=>{console.log("Data:",e),console.log("JWT",e.jwt),console.log("User",e.user),new Promise(((s,o)=>{s((e=>{f("user",e,{path:"/",domain:".kbve.com",secure:!0,sameSite:"strict"})})(e.user))})).then(window.location="https://kbve.com/profile")}));console.log(`\tLoginConfirmation::Success:\n${JSON.stringify(s,null,2)}`)}))},disabled:h,children:"Login"})})})]})})})})};export{U as default};